angular.module("TNotify",[]).directive("tNotify",function(){return{restrict:"E",replace:true,scope:true,template:'<div class="tnotify-overlay">'+'<div class="tnotify">'+'<div class="tnotify-inner" ng-class="{remind: type === \'remind\'}">'+'<div class="tnotify-title" ng-if="title">{{ title }}</div>'+'<div class="tnotify-text" ng-if="text">{{ text }}</div>'+'<input type="{{ inputType }}" placeholder="{{ inputPlaceHolder }}" class="tnotify-text-input" ng-if="type === \'prompt\'" ng-model="form.input">'+"</div>"+'<div class="tnotify-buttons" ng-if="type !== \'remind\'">'+'<span class="tnotify-button" ng-if="type !== \'alert\'" ng-click="onCancel()">{{ cancelText }}</span>'+'<span class="tnotify-button tnotify-button-bold" ng-click="onOk(input)">{{ okText }}</span>'+"</div>"+"</div>"+"</div>"}}).factory("transition",["$window",function(t){var n=t.document.createElement("div");var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"};var i={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};var o=function(t){for(var e in t){if(n.style[e]!==undefined){return t[e]}}};return{transitionEndEventName:o(e),animationEndEventName:o(i)}}]).provider("TNotify",function(){var t={title:null,text:null,form:{input:""},inputType:"text",inputPlaceHolder:"",cancelText:"取消",okText:"确定"};var n=["title","text","cancelText","okText","inputType","inputPlaceHolder"];this.set=function(e,i){var o=this;if(angular.isObject(e)){for(var r in e){o.set(r,e[r])}}else{if(e&&n.indexOf(e)>-1){if(i){t[e]=i}}}};this.$get=["$rootScope","$compile","$animate","$q","$document","$timeout","transition",function(n,e,i,o,r,a,s){function l(l){var f,u,d;var c="tnotify-in",p="tnotify-out",m="tnotify-animate",y="tnotifyEnd";f=o.defer();s.transitionEndEventName=s.transitionEndEventName||y;u=n.$new(true);angular.extend(u,t,l);d=e("<t-notify></t-notify>")(u);u.onCancel=function(){if(u.type==="confirm"){f.resolve(false)}else if(u.type==="prompt"){f.resolve(null);u.form.input=""}u.$destroy()};u.onOk=function(){if(u.type==="prompt"){f.resolve(u.form.input||"");u.form.input=""}else{f.resolve(true)}u.$destroy()};i.enter(d,angular.element(r[0].body),angular.element(r[0].body.lastChild)).then(function(){u.$on("$destroy",function(){d.one(s.transitionEndEventName,function(){d.remove()});d.addClass(p);if(s.transitionEndEventName===y){d.triggerHandler(y)}});d.addClass(m).addClass(c);if(u.type==="remind"){if(s.transitionEndEventName===y){a(u.onOk,650)}else{d.one(s.transitionEndEventName,function(){a(u.onOk,250)})}}});return f.promise}function f(t){if(angular.isString(t)){return{text:t}}else if(angular.isObject(t)){return t}else{throw new Error("expect a string or a object");return{}}}function u(t){t=f(t);t.type="alert";return l(t)}function d(t){t=f(t);t.type="confirm";return l(t)}function c(t){t=f(t);t.type="prompt";return l(t)}function p(t){t=f(t);t.type="remind";return l(t)}return{alert:u,confirm:d,prompt:c,remind:p}}]});