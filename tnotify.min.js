angular.module("TNotify",[]).directive("tNotify",function(){return{restrict:"E",replace:true,scope:true,template:'<div class="tnotify-overlay">'+'<div class="tnotify">'+'<div class="tnotify-inner">'+'<div class="tnotify-title" ng-if="title">{{ title }}</div>'+'<div class="tnotify-text" ng-if="text">{{ text }}</div>'+'<input type="{{ inputType }}" placeholder="{{ inputPlaceHolder }}" class="tnotify-text-input" ng-if="type === \'prompt\'" ng-model="form.input">'+"</div>"+'<div class="tnotify-buttons">'+'<span class="tnotify-button" ng-if="type !== \'alert\'" ng-click="onCancel()">{{ cancelText }}</span>'+'<span class="tnotify-button tnotify-button-bold" ng-click="onOk(input)">{{ okText }}</span>'+"</div>"+"</div>"+"</div>"}}).factory("TRANSITION_END_NAME",["$window",function(t){var n=["Moz","webkit","ms","O"];var e={Moz:"transitionend",webkit:"webkitTransitionEnd",ms:"MSTransitionEnd",O:"oTransitionEnd"};var i={Moz:"animationend",webkit:"webkitAnimationEnd",ms:"MSAnimationEnd",O:"oAnimationEnd"};var o,r,a;var l=t.document.createElement("div");for(var f=0,s=n.length;f<s;f++){o=n[f];if(o+"Transition"in l.style){break}o=false}if(o){r=e[o];a=i[o]}return r}]).provider("TNotify",function(){var t={title:null,text:null,form:{input:""},inputType:"text",inputPlaceHolder:"",cancelText:"取消",okText:"确定"};var n=["title","text","cancelText","okText","inputType","inputPlaceHolder"];this.set=function(e,i){var o=this;if(angular.isObject(e)){for(var r in e){o.set(r,e[r])}}else{if(e&&n.indexOf(e)>-1){if(i){t[e]=i}}}};this.$get=["$rootScope","$compile","$animate","$q","$document","TRANSITION_END_NAME",function(n,e,i,o,r,a){function l(l){var f=o.defer();var s=n.$new(true);angular.extend(s,t,l);s.onCancel=function(){if(s.type==="confirm"){f.resolve(false)}else if(s.type==="prompt"){f.resolve(null);s.form.input=""}s.$destroy()};s.onOk=function(){if(s.type==="prompt"){f.resolve(s.form.input||"");s.form.input=""}else{f.resolve(true)}s.$destroy()};var u=e("<t-notify></t-notify>")(s);i.enter(u,angular.element(r[0].body),angular.element(r[0].body.lastChild)).then(function(){u.addClass("tnotify-animate tnotify-in");s.$on("$destroy",function(){u.on(a,function(){u.off(a).remove()});u.addClass("tnotify-out")})});return f.promise}function f(t){if(angular.isString(t)){return{text:t}}else if(angular.isObject(t)){return t}else{throw new Error("expect a string or a object");return{}}}function s(t){t=f(t);t.type="alert";return l(t)}function u(t){t=f(t);t.type="confirm";return l(t)}function c(t){t=f(t);t.type="prompt";return l(t)}return{alert:s,confirm:u,prompt:c}}]});